{%- import "macros.html" as macros -%}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="/assets/main.css">
    <!-- Simple styles - fix later -->
<!--    <link rel="stylesheet" href="https://unpkg.com/mvp.css">-->
    <title>{% block title %}Title{% endblock %}</title>
</head>
<body>
    <div class="navbar bg-base-300 rounded-box">
        <div class="flex-1 px-2 lg:flex-none">
            <a class="text-lg font-bold" style="font-size: 40px">{{m("protests")}} &#127480; &#127480; ðŸ‡¸ðŸ‡°</a>
        </div>
        <div class="flex flex-1 justify-end px-2">
            <div class="flex items-stretch">
                <a class="btn btn-ghost rounded-btn">Button</a>
                <div class="dropdown dropdown-end">
                    <div tabindex="0" role="button" class="btn btn-ghost rounded-btn">Dropdown</div>
                    <ul
                            tabindex="0"
                            class="menu dropdown-content bg-base-100 rounded-box z-[1] mt-4 w-52 p-2 shadow">
                        <li><a>Item 1</a></li>
                        <li><a>Item 2</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <script>
            document.getElementById('language-dropdown').addEventListener('change', (event) =>
                fetch(`change-language/${event.target.value}`).then(() => window.location.reload())
            )
        </script>
        {% call macros::theme_selector() %}
    </div>



    <button type="button" onclick="document.getElementById('login-form').style.display = 'block'">{{ m("login") }}</button>
    <form id="login-form" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center;">
        <div style="margin: 0;">
        <!-- Login Form -->
            <input type="text" name="email" placeholder='{{ m("email") }}' style="display: block; margin: 10px auto; padding: 10px; width: 80%; font-size: 16px;">
            <button type="submit" style="display: block; margin: 10px auto; padding: 10px; width: 80%; font-size: 16px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Login
            </button>
            <script>
                document.getElementById('login-form').addEventListener('submit', async (event) => {
                    event.preventDefault();
                    const data = new URLSearchParams();
                    for (const pair of new FormData(document.getElementById('login-form'))) {
                        data.append(pair[0], pair[1]);
                    }
                    const response = await fetch('/login/generate-code', {
                        method: 'POST',
                        body: data,
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        }
                    });

                    const protocol = window.location.protocol;
                    const host = window.location.hostname;
                    const port = window.location.port;
                    const path = await response.text();

                    const link = `${protocol}//${host}${port ? `:${port}` : ''}${path}`;
                    document.getElementById('login-form').style.display = 'none';
                    const loginLink = document.getElementById('login-link');
                    loginLink.innerHTML = `Login with link: <a href="${link}">${link}</a>`;
                    loginLink.style.display = 'block';
                });
            </script>
        </div>
    </form>
    <div id="login-link" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center;">
    </div>


    <div id="header">
        <h1>{% block title %}Title{% endblock %}</h1>
    </div>
    <div id="content">
        {% block content %}Content{% endblock %}
    </div>
</body>
</html>
